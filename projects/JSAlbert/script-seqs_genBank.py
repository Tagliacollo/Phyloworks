from genBank import *
from utilities import output_path
import os
import itertools

################

email = 'victor_tagliacollo@yahoo.com.br'
gene  = 'CYTB'
cwd = '/Volumes/VATagliacollo/GitHub/Phyloworks/py_scripts'


ssp_list = ['Paratrygon aiereba','Potamotrygon motoro','Potamotrygon falkneri','Potamotrygon orbygnyi','Potamotrygon tatianae','Arapaima gigas','Lycengraulis batesii','Anchoviella carrikeri','Ilisha amazonica','Abramites hypselonotus','Leporellus vittatus','Leporinus friderici','Leporinus pearsoni','Leporinus striatus','Leporinus trifasciatus','Schizodon fasciatus','Acestrocephalus boehlkei','Acestrocephalus pallidus','Acestrorhynchus falcatus','Aphyocharax pusillus','Aphyocharax sp. 1','Astyanacinus multidens','Astyanax abramis','Astyanax bimaculatus','Astyanax aff. fasciatus','Astyanax maximus','Astyanax sp. 1 "small scales"','Astyanax sp. 1 "blunt snout"','Astyanax sp. 3 "short head"','Attonitus ephimeros','Brachychalcinus copei','Bryconacidnus sp','Bryconamericus pachacuti','Bryconamericus pectinatus','Bryconamericus sp. 1','Bryconamericus sp. 1','Ceratobranchia obtusirostris','Charax sp. 1.','Charax sp. 1','Charax caudimaculatus','Charax tectifer','Clupeacharax anchoveoides','Creagrutus barrigai','Creagrutus changae','Creagrutus occidaneus','Creagrutus pila','Creagrutus ungulus','Creagrutus sp.','Ctenobrycon hauxwellianus','Cynopotamus amazonus','Cynopotamus gouldingi','Engraulisoma taeniatum','Galeocharax gulo','Galeocharax goeldi','Gephyrocharax sp.','Gymnocorymbus thayeri','Hemibrycon jeltskii','Hemigrammus marginatus','Knodus hypopterus','Knodus orteguasae','Knodus smithi','Knodus sp. 1','Knodus sp. 1','Leptagoniates steindachneri','Microgenys sp.','Moenkhausia comma','Moenkhausia dichoura','Moenkhausia chrysargirea','Moenkhausia intermedia','Moenkhausia gr. lepidura','Moenkhausia oligolepis','Moenkhausia sp.','Odontostilbe euspilura','Odontostilbe fugitiva','Odontostilbe sp. 1','Odontostilbe sp. 1','Odontostilbe sp. 3','Odontostilbe sp. 4','Paragoniates alburnus','Phenacogaster capitulatus','Phenacogaster cf. beni','Prionobrama filigera','Prodontocharax melanotus','Roeboides affinis','Roeboides descalvadensis','Roeboides myersii','Scopaeocharax cf. rhinodus','Salminus sp.','Serrapinnus aff. microdon','Tetragonopterus argentus','Triportheus albus','Triportheus anuglatus','Triportheus auritus','Triportheus rotundatus','Xenurobrycon heterodon','Characidium purpuratum','Characidium steindachneri','Characidium sp. 1 wide stripe cocha','Characidium sp. 1 thin stripe playa','Geryichthys sterbai','Curmatella meyeri','Cyphocharax cf. festivus','Cyphocharax spiluropsis','Potamorhina altamazonica','Potamorhina latior','Psectrogaster rutiloides','Steindachnerina bimaculata','Steindachnerina cf. dobula','Steindachnerina guentheri','Steindachnerina hypostoma','Steindachnerina leuscisca','Hydrolycus scomberoides','Rhaphiodon vulpinus','Erythrinus erythrinus','Hoplerythrinus uniaeniatus','Hoplias malabaricus','Carnegiella myersi','Thoracocharax stellatus','Anodus elongatus','Copeina guttata','Parodon pongoensis','Parodon sp.','Prochilodus nigricans','Mylossoma aureum','Mylossoma duriventris','Pristobrycon sp.','Pygocentrus nattereri','Serrasalmus rhombeus','Serrasalmus maculatus','Bunocephalus coracoideus','Pseudobunocephalus bifidus','Xyliphius lepturus','Ageneiosus ucayalensis','Ageneiosus inermis','Auchenipterus ambyiacus','Auchenipterus brachyurus','Centromochlus perugiae','Callichthys callichthys','Corydoras aeneus','Corydoras splendens','Corydoras stenocephalus','Dianema longibarbis','Hoplosternum littorale','Lepthoplosternum altamazonicum','Lepthoplosternum cf. stellatum','Cetopsis coecutiens','Leptodoras acipenserinus','Nemadoras sp.','Rhinodoras boehlkei','Trachydoras steindachneri','Cetopsorhamdia cf. insidiosa','Cetopsorhamdia sp.','Chasmocranus sp.','Imparfinis sp.','Imparfinis stictonotus','Phenacorhamdia nigrolineata','Phenacorhamdia sp.','Pimelodella cf. gracilis','Pimelodella sp. 1','Pimelodella sp. 1','Rhamdia quelen','Acanthicus hystrix','Ancistrus dolichopterus','Ancistrus sp. 1','Ancistrus sp. 1','Ancistrus sp. 3','Ancistrus sp. 4','Ancistrus sp. 5','Ancistrus sp. 6','Ancistrus sp. 7','Chaetostoma lineopunctatum','Crossoloricaria rhami','Crossoloricaria bahuaja','Farlowella knerii','Farlowella nattereri','Farlowella smithi','Hemiodontichthys acipenserinus','Hypoptopoma thoracatum','Hypoptopoma incognetum','Hypostomus emarginatus','Hypostomus pyrineusi','Hypostomus unicolor','Hypostomus sp. 1 black blotches','Hypostomus sp. 1 white saddle','Lamontichthys filamentosus','Lasiancistrus schomburgkii','Limatulichthys griseus','Loricaria sp.','Loricariichthys sp.','Loricariichthys aff. platymetopon','Otocinclus vittatus','Panaqolus albomaculatus','Panaqolus changae','Panaqolus purusiensis','Panaque schaeferi','Peckoltia brevis','Planiloricaria cryptodon','Pseudorinelepis genibarbis','Pterygoplichthys disjunctivus','Pterygoplichthys lituratus','Pterygoplichthys punctatus','Pterygoplichthys pardalis','Pterygoplichthys scrophus','Rineloricaria lanceolata','Rineloricaria sp.','Spatuloricaria puganensis','Sturisoma nigrirostrum','Sturisoma sp.','Aguarunichthys torosus','Brachyplatystoma filamentosum','Brachyplatystoma juruense','Brachyplatystoma rousseauxi','Calophysus macropterus','Cheirocerus eques','Duopalatinus peruanus','Exallodontus aguanai','Hemisorubim platyrhynchos','Hypophtalmus edentatus','Megalonema amaxanthum','Megalonema platycephalum','Pimelodina flavipinnis','Pimelodus altissimus','Pimelodus blochii','Pimelodus maculatus','Pimelodus ornatus','Pimelodus pictus','Pimelodus sp. 1 "pequeno"','Pimelodus sp. 1','Pinirampus piriniampu','Platysilurus mucosus','Platystomatichthys sturio','Sorubim lima','Sorubim maniradii','Zungaro zungaro','Batrochoglanis raninus','Microglanis aff. iheringi','Pseudopimelodus pulcher','Acanthopoma annectens','Henonemus punctatus','Plectrochilus sp.','Pseudostegophilus nemurus','Tridentopsis pearsoni','Apteronotus albifrons','Apteronotus bonapartii','Sternarchorhynchus stewarti','Sternarchorhynchus sp.','Electrophorus electricus','Gymnotus carapo','Gymnotus chaviro','Gymnotus ucamara','Brachyhypopomus beebei','Brachyhypopomus electropomus','Eigenmannia virescens','Eigenmannia aff. trilineata','Sternopygus macrurus','Rivulus sp.','Pseudotylosurus angusticeps','Aequidens tetramerus','Bujurquina cordimadi','Bujurquina robusta','Bujurquina cf. eurhinus','Cichlasoma amazonarum','Cichlasoma boliviense','Crenicichla proteus','Crenicichla sedentaria','Crenicichla semicincta','Pachyurus schomburgkii','Pachyurus cf. stewarti','Synbranchus madeirae','Plagioscyon squamosissimus','Apionichthys finis','Hypoclinemus mentalis']

get_seqs = []
for sp in ssp_list:
	print ('acquiring %s sequences for: %s' % (gene, sp))

	try:
	  get_seqs.append(provides_species_get_unalign_fasta(sp, gene, email, outfilename=sp, batch=500, rank = 1))

	except:
		pass

merge_seqs = list(itertools.chain(*get_seqs))
SeqIO.write(merge_seqs, '%s_Fritz.fas' % (gene), 'fasta')

